# ä¸€ã€ç³»ç»Ÿç»“æ„è®¾è®¡

## 1.1 ä½“ç³»ç»“æ„

### 1.1.1 å‰ç«¯ä½“ç³»ç»“æ„

### 1.1.2 åç«¯ä½“ç³»ç»“æ„

åœ¨æ•°æ®åº“çš„æ­å»ºä¸Šï¼Œæˆ‘ä½¿ç”¨äº†`sql`è¯­å¥è¿›è¡Œåˆå§‹åŒ–ï¼Œå¹¶æ’å…¥äº†ä¸»è¦çš„å…³é”®æ•°æ®ã€‚

åç«¯ä½¿ç”¨äº†`django`æ¡†æ¶ï¼Œæ¥æ”¶æ¥è‡ªå‰ç«¯çš„`http`è¯·æ±‚ï¼Œä¸äº‘æ•°æ®åº“`Guass DB`è¿›è¡Œäº¤äº’ï¼Œå°†æ•´ç†å¥½çš„æ•°æ®ä¼ å›å‰ç«¯æˆ–ä¿ç•™åœ¨åç«¯ã€‚

Djangoä½œä¸ºä¸€ä¸ªåç«¯æ¡†æ¶ï¼Œä¸»è¦æä¾›ä»¥ä¸‹ä¸»è¦åŠŸèƒ½ï¼š

1. **ORMï¼ˆå¯¹è±¡å…³ç³»æ˜ å°„ï¼‰ï¼š** Djangoæä¾›äº†å¼ºå¤§çš„ORMç³»ç»Ÿï¼Œå…è®¸å¼€å‘è€…ä½¿ç”¨Pythonä»£ç è€Œä¸æ˜¯SQLè¯­å¥æ¥å®šä¹‰å’Œæ“ä½œæ•°æ®åº“æ¨¡å‹ã€‚è¿™ç®€åŒ–äº†æ•°æ®åº“æ“ä½œï¼Œæé«˜äº†ä»£ç çš„å¯è¯»æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚
2. **è§†å›¾å’Œæ¨¡æ¿ç³»ç»Ÿï¼š** Djangoé‡‡ç”¨MVCï¼ˆModel-View-Controllerï¼‰è®¾è®¡æ¨¡å¼ï¼Œå…¶ä¸­è§†å›¾ï¼ˆViewï¼‰è´Ÿè´£å¤„ç†è¯·æ±‚å¹¶è¿”å›å“åº”ï¼Œæ¨¡æ¿ï¼ˆTemplateï¼‰ç”¨äºå®šä¹‰HTMLé¡µé¢çš„ç»“æ„ã€‚è¿™ä½¿å¾—å¼€å‘è€…èƒ½å¤Ÿæ›´å¥½åœ°ç»„ç»‡å’Œåˆ†ç¦»ä¸šåŠ¡é€»è¾‘ã€è¡¨ç°é€»è¾‘å’Œæ•°æ®æ¨¡å‹ã€‚
3. **è·¯ç”±ç³»ç»Ÿï¼š** Djangoçš„URLæ˜ å°„ç³»ç»Ÿå…è®¸å¼€å‘è€…å°†ä¸åŒçš„URLè¯·æ±‚è·¯ç”±åˆ°ç›¸åº”çš„è§†å›¾å‡½æ•°ï¼Œä»è€Œå®ç°å¯¹ä¸åŒåŠŸèƒ½çš„æœ‰æ•ˆåˆ†å‘ã€‚è¿™ç§æ˜ å°„æ˜¯åœ¨é¡¹ç›®çš„`urls.py`æ–‡ä»¶ä¸­å®šä¹‰çš„ã€‚

#### 1.1.2.1 åç«¯ç¯å¢ƒ

å…·ä½“æ‰€éœ€ä¾èµ–è§ä¸‹

```
aiohttp==3.9.1
aiosignal==1.3.1
annotated-types==0.6.0
anyio==3.7.1
asgiref==3.7.2
async-timeout==4.0.3
attrs==23.1.0
certifi==2023.11.17
charset-normalizer==3.3.2
colorama==0.4.6
distro==1.8.0
Django==4.2.6
django-cors-headers==4.3.1
djangorestframework==3.14.0
exceptiongroup==1.2.0
frozenlist==1.4.0
h11==0.14.0
httpcore==1.0.2
httpx==0.25.1
idna==3.4
multidict==6.0.4
mysqlclient==2.2.0
numpy==1.26.1
openai==0.28.0
pydantic==2.5.1
pydantic_core==2.14.3
PyJWT==2.8.0
PyMySQL==1.1.0
pytz==2023.3.post1
requests==2.31.0
sniffio==1.3.0
sqlparse==0.4.4
tqdm==4.66.1
typing_extensions==4.8.0
tzdata==2023.3
urllib3==2.1.0
yarl==1.9.3
```

#### 1.1.2.2 åç«¯æ¡†æ¶

```
.
â”œâ”€â”€ __init__.py
â”œâ”€â”€ avatar.jpg
â”œâ”€â”€ avatar_admin.jpg
â”œâ”€â”€ db.sqlite3
â”œâ”€â”€ manage.py
â”œâ”€â”€ migrations
â”‚Â Â  â”œâ”€â”€ __init__.py
â”‚Â Â  â”œâ”€â”€ asgi.py
â”‚Â Â  â”œâ”€â”€ gptAnswer.py
â”‚Â Â  â”œâ”€â”€ info.json
â”‚Â Â  â”œâ”€â”€ initialDB.py
â”‚Â Â  â”œâ”€â”€ models.py
â”‚Â Â  â”œâ”€â”€ mysql.py
â”‚Â Â  â”œâ”€â”€ settings.py
â”‚Â Â  â”œâ”€â”€ testviews.py
â”‚Â Â  â”œâ”€â”€ upload.py
â”‚Â Â  â”œâ”€â”€ urls.py
â”‚Â Â  â”œâ”€â”€ views.py
â”‚Â Â  â””â”€â”€ wsgi.py
â””â”€â”€ test.py
```

å…·ä½“æ¡†æ¶å¦‚ä¸Šæ‰€ç¤ºã€‚

* `views.py`ï¼šå­˜æ”¾ä¸»è¦æ–¹æ³•
* `mysql.py`ï¼šå­˜æ”¾æ•°æ®æ“ä½œæ–¹æ³•
* `urls.py`ï¼šå­˜æ”¾è·¯ç”±åœ°å€
* `testviews.py`ï¼šå­˜æ”¾æµ‹è¯•æ–¹æ³•
* `models.py`ï¼šå­˜æ”¾ç”±æ•°æ®åº“æ˜ å°„çš„`ORM`
* `database.sql`ï¼šå­˜æ”¾åˆå§‹åŒ–æ•°æ®çš„`sql`è¯­å¥ã€‚
* `manage.py`ï¼š`django`ä¸­çš„å‘½ä»¤è¡Œå·¥å…·
* `gptAnswer.py`ï¼šå­˜æ”¾è°ƒç”¨`chatgpt`æ¥å£

## 1.2 åŠŸèƒ½ç»“æ„

æœ¬æ¬¡ä½œä¸šçš„å†…å®¹æ˜¯ä¸€ä¸ªæ”¯æŒå¤šç§ç”¨æˆ·çš„åŒ—èˆªæ ¡åŒ»é™¢åº”ç”¨ç³»ç»Ÿï¼Œå…¶ä¸­æ¶‰åŠçš„å®ä½“æœ‰ï¼šç—…äººï¼ŒåŒ»ç”Ÿï¼Œç®¡ç†å‘˜ï¼ŒåŒ–éªŒè®¢å•ï¼Œè¯å“è®¢å•ï¼Œè¯Šæ–­è®¢å•ï¼ŒæŒ‚å·è®¢å•ï¼Œè¯Šå®¤ï¼Œéƒ¨é—¨ï¼Œè¯å“ç­‰

* ç—…äººæ¨¡å—
  1. æŸ¥çœ‹è‡ªèº«è®¢å•
  2. æ”¯ä»˜è®¢å•
  3. æŸ¥çœ‹è¯Šæ–­ç»“æœ
  4. æŸ¥çœ‹åŒ–éªŒå•ç»“æœ
  5. æ ¹æ®åŒ»é™¢æ’ç­è‡ªåŠ¨æŒ‚å·é¢„çº¦
  6. æ™ºèƒ½å¯¼åŒ»å°
* åŒ»ç”Ÿæ¨¡å—
  1. å¼€è¯
  2. ä¸‹è¯Šæ–­ä¹¦
  3. æä¾›åŒ–éªŒå•
  4. æŸ¥çœ‹è‡ªèº«æ’ç­
* ç®¡ç†å‘˜æ¨¡å—
  1. å¢åŠ åŒ»ç”Ÿ
  2. å¢åŠ ç¤¾åŒºç—…äºº
  3. å¢åŠ æ–°è¯å“
  4. åˆ é™¤è¯å“
  5. æŸ¥çœ‹ç—…äººä¿¡æ¯ï¼ŒæŸ¥çœ‹ç—…äººæµæ°´æƒ…å†µ
  6. æŸ¥çœ‹åŒ»ç”Ÿä¿¡æ¯

# äºŒã€æ•°æ®åº“åŸºæœ¬è¡¨å®šä¹‰

æ•°æ®åº“åŒ…å«7ä¸ªå®ä½“ï¼Œ14å¼ è¡¨ï¼Œä½¿ç”¨`sql`è¯­å¥è¿›è¡Œæ•°æ®åº“åˆå§‹åŒ–ï¼Œå¹¶å°†æ•°æ®åº“è¿ç§»åˆ°`django.models`ä¸­ï¼Œæ¯ä¸ªè¡¨å¯¹åº”ä¸€ä¸ªæ¨¡å‹ç±»ï¼Œç±»ä¸­çš„å±æ€§å¯¹åº”å¯¹åº”è¡¨ä¸­çš„åˆ—ã€‚

å…·ä½“å®šä¹‰ä»¥åŠå®ç°ä»£ç è§ä¸‹ï¼š

## ç”¨æˆ·éƒ¨åˆ†

ç”±äºæˆ‘ä»¬çš„é¢˜ç›®ä¸­å­˜åœ¨å¤šç§ç”¨æˆ·ï¼Œå› æ­¤æˆ‘é‡‡ç”¨äº†çˆ¶ç±»-å­ç±»çš„æ¶æ„ï¼Œç”±`User`è¡¨ä½œä¸ºçˆ¶ç±»ï¼Œ`Doctor`å’Œ`Patient`ä½œä¸ºå­ç±»ï¼Œé€šè¿‡`User.type`è¿›è¡Œåˆ¤æ–­ï¼Œè€Œç®¡ç†å‘˜è¡¨ä¸­å¹¶æ— å¤šä½™ä¿¡æ¯ï¼Œå› æ­¤æˆ‘å¹¶æ²¡æœ‰é’ˆå¯¹ç®¡ç†å‘˜å»ºè¡¨ã€‚

ç‰¹åˆ«çš„æ˜¯ï¼Œå¯¹äºæˆ‘ä»¬çš„å¤´åƒï¼Œæˆ‘ä»¬ä½¿ç”¨äº†æˆ‘ä»¬ç»„å‘˜è‡ªå·±æ­å»ºçš„å›¾åºŠ[www.imgbed.sanyue.site](https://imgbed.sanyue.site/)ï¼Œåœ¨ä»–çš„å¸®åŠ©ä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥å°†å›¾ç‰‡åœ¨çº¿ä¸Šä¼ åˆ°å›¾åºŠä¸­ï¼Œå‡å°‘æ•°æ®åº“çš„å†—ä½™ã€‚

è¡¨çš„å±æ€§è§ä¸‹ã€‚

### 2.0 User(ç”¨æˆ·è¡¨)

| å±æ€§     | ä¸­æ–‡   | ç±»å‹         | å¤‡æ³¨           |
| -------- | ------ | ------------ | -------------- |
| id       | ç¼–å·   | VARCHAR(25)  | NOT NULLï¼Œä¸»ç  |
| username | ç”¨æˆ·å | VarCHAR(25)  | NOT NULL       |
| password | å¯†ç    | VarCHAR(25)  | NOT NULL       |
| type     | ç±»å‹   | VarCHAR(25)  | NOT NULL       |
| avatar   | å¤´åƒ   | VARCHAR(150) | NOT NULL       |

```python
class User(models.Model):
    id = models.CharField(primary_key=True, max_length=25)
    username = models.CharField(db_column='USERNAME', max_length=25)  # Field name made lowercase.
    password = models.CharField(max_length=25)
    type = models.CharField(max_length=25)
    avatar = models.CharField(db_column='AVATAR', max_length=150, blank=True, null=True)  # Field name made lowercase.

    class Meta:
        managed = False
        db_table = 'user'
```

### 2.1 Patient(ç—…äººè¡¨)ç»§æ‰¿User

| å±æ€§     | ä¸­æ–‡           | ç±»å‹        | å¤‡æ³¨           |
| -------- | -------------- | ----------- | -------------- |
| id       | ç”¨æˆ·å         | VARCHAR(25) | NOT NULLï¼Œå¤–ç  |
| isComMem | æ˜¯å¦ä¸ºç¤¾åŒºæˆå‘˜ | BOOLEAN     | NOT NULL       |
| active   | æ˜¯å¦è¢«åˆ é™¤     | BOOLEAN     | NOT NULL       |
| idCard   | èº«ä»½è¯å·       | VarCHAR(25) |                |

```py
class Patient(models.Model):
    id = models.CharField(primary_key=True, max_length=25)
    iscommem = models.IntegerField(db_column='isComMem')  # Field name made lowercase.
    idcard = models.CharField(db_column='idCard', max_length=25, blank=True, null=True)  # Field name made lowercase.
    active = models.IntegerField()

    class Meta:
        managed = False
        db_table = 'patient'
```



### 2.2 Doctor(åŒ»ç”Ÿè¡¨)ç»§æ‰¿User

| å±æ€§     | ä¸­æ–‡         | ç±»å‹        | å¤‡æ³¨                   |
| -------- | ------------ | ----------- | ---------------------- |
| id       | åŒ»ç”Ÿç¼–å·     | VARCHAR(25) | NOT NULLï¼Œå¤–ç ç»§æ‰¿User |
| active   | æ˜¯å¦æ´»è·ƒ     | BOOLEAN     | NOT NULL               |
| Tid      | è´Ÿè´£ç§‘å®¤ç¼–å· | VarCHAR(25) | NOT NULL               |
| jobtitle | èŒç§°         | VARCHAR(25) | NOT NULL               |

```py
class Doctor(models.Model):
    id = models.CharField(primary_key=True, max_length=25)
    tid = models.ForeignKey('Titles', models.DO_NOTHING, db_column='Tid')  # Field name made lowercase.
    jobtitle = models.CharField(db_column='JobTitle', max_length=25)  # Field name made lowercase.
    active = models.IntegerField()

    class Meta:
        managed = False
        db_table = 'doctor'
```

## åŒ»é™¢å®ä½“

åŒ»é™¢å®ä½“ä¸»è¦åŒ…æ‹¬äº†ç§‘å®¤ï¼Œè¯å“ï¼Œè¯Šå®¤å’Œæ£€æŸ¥é¡¹ç›®å››ç§ä¸åŒçš„å®ä½“ã€‚åŸºæœ¬å®ç°è§ä¸‹

### 2.3 Title(ç§‘å®¤è¡¨)

| å±æ€§ | ä¸­æ–‡ | ç±»å‹        | å¤‡æ³¨          |
| ---- | ---- | ----------- | ------------- |
| id   | ç¼–å· | VARCHAR(25) | NOT NULL,ä¸»ç  |
| name | åç§° | VARCHAR(25) | NOT NULL      |

```python
class Titles(models.Model):
    id = models.CharField(primary_key=True, max_length=25)
    name = models.CharField(max_length=25)

    class Meta:
        managed = False
        db_table = 'titles'
```



### 2.4 Drug(è¯å“è¡¨)

| å±æ€§        | ä¸­æ–‡       | ç±»å‹        | å¤‡æ³¨           |
| ----------- | ---------- | ----------- | -------------- |
| id          | è¯å“ç¼–å·   | VARCHAR(25) | NOT NULLï¼Œä¸»ç  |
| isBanned    | æ˜¯å¦è¢«ç¦æ­¢ | BOOLEAN     | NOT NULL       |
| price       | è¯å“ä»·æ ¼   | FLOAT       | NOT NULL       |
| Storage     | å­˜å‚¨é‡     | FLOAT       | NOT NULL       |
| description | è¯å“æè¿°   | TEXT        | NOT NULL       |

```python
class Drug(models.Model):
    id = models.CharField(primary_key=True, max_length=25)
    name = models.CharField(max_length=25)
    price = models.FloatField()
    description = models.TextField(db_column='Description')  # Field name made lowercase.
    isbanned = models.IntegerField(db_column='isBanned')  # Field name made lowercase.
    storage = models.FloatField(db_column='Storage')  # Field name made lowercase.

    class Meta:
        managed = False
        db_table = 'drug'
```

### 2.5 ROOM(è¯Šå®¤è¡¨)

| å±æ€§       | ä¸­æ–‡       | ç±»å‹        | å¤‡æ³¨           |
| ---------- | ---------- | ----------- | -------------- |
| id         | è¯Šå®¤ç¼–å·   | VARCHAR(25) | NOT NULLï¼Œä¸»ç  |
| isOccupied | æ˜¯å¦è¢«å ç”¨ | BOOLEAN     | NOT NULL       |
| QueueLen   | æ’é˜Ÿäººæ•°   | int         | NOT NULL       |

```python
class Room(models.Model):
    id = models.CharField(primary_key=True, max_length=25)
    isoccupied = models.IntegerField(db_column='isOccupied')  # Field name made lowercase.
    queuelen = models.IntegerField(db_column='QueueLen')  # Field name made lowercase.

    class Meta:
        managed = False
        db_table = 'room'
```



### 2.6 checkItems(æ£€æŸ¥é¡¹ç›®)

| å±æ€§        | ä¸­æ–‡         | ç±»å‹         | å¤‡æ³¨           |
| ----------- | ------------ | ------------ | -------------- |
| id          | æ£€æŸ¥é¡¹ç›®ç¼–å· | VARCHAR(25)  | NOT NULLï¼Œä¸»ç  |
| price       | æ£€æŸ¥é¡¹ç›®ä»·æ ¼ | FLOAT        | NOT NULL       |
| description | æ£€æ“¦é¡¹ç›®æè¿° | VARCHAR(255) | NOT NULL       |
| MinResult   | æœ€å°å€¼       | FLOAT        | NOT NULL       |
| MaxResult   | æœ€å¤§å€¼       | FLOAT        | NOT NULL       |

```python
class Checkitems(models.Model):
    id = models.CharField(primary_key=True, max_length=25)
    price = models.FloatField()
    description = models.CharField(max_length=255)
    minresult = models.FloatField(db_column='MinResult')  # Field name made lowercase.
    maxresult = models.FloatField(db_column='MaxResult')  # Field name made lowercase.

    class Meta:
        managed = False
        db_table = 'checkitems'
```

## å…³ç³»è¡¨

å…³ç³»è¡¨ä¸»è¦åˆ†ä¸ºä»¥ä¸‹å‡ ç±»ï¼š

1. ä»˜è´¹è®¢å•

   åŒ…æ‹¬äº†

   1. æŒ‚å·
   2. å¼€è¯
   3. åŒ–éªŒ

2. å…è´¹è®¢å•ï¼Œç›®å‰åªæ”¯æŒè¯Šæ–­ç»“æœ

3. æ’ç­å…³ç³»ï¼Œå±•ç¤ºåŒ»ç”Ÿæ’ç­æƒ…å†µã€‚

å¯¹äºä»˜è´¹è®¢å•ç±»ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†`Counter`ä½œä¸ºåŸºæœ¬è¡¨ï¼Œä»¥å…¶ä¸ºåŸºç¡€ï¼Œç”¨`RegistRelation`,`MedicinePurchase`,`LaboratoryShee`ä¸‰ä¸ªè¡¨æ¥å¯¹å…¶è¿›è¡Œç»§æ‰¿ï¼Œä½¿ç”¨äº†`Counter.id`ä½œä¸ºå¤–ç ï¼Œä¿æŒçˆ¶å­è¡¨çš„å…³ç³»ã€‚

### 2.7 Counter(è®¢å•è¡¨)

| å±æ€§   | ä¸­æ–‡       | ç±»å‹        | å¤‡æ³¨                      |
| ------ | ---------- | ----------- | ------------------------- |
| id     | è®¢å•ç¼–å·   | VARCHAR(25) | NOT NULL, ä¸»ç             |
| isPaid | æ˜¯å¦å·²æ”¯ä»˜ | BOOLEAN     | NOT NULL                  |
| price  | ä»·æ ¼       | FLOAT       | NOT NULL                  |
| Pid    | ç—…äººç¼–å·   | VARCHAR(25) | NOT NULLï¼Œå¤–ç ç»§æ‰¿Patient |
| Did    | åŒ»ç”Ÿç¼–å·   | VARCHAR(25) | NOT NULL,å¤–ç ç»§æ‰¿DOCTOR   |
| DATE   | æ—¥æœŸ       | DATE        | NOT NULL                  |
| type   | è®¢å•ç§ç±»   | VARCHAR(25) | NOT NULL                  |

```python
class Counter(models.Model):
    id = models.CharField(primary_key=True, max_length=25)
    pid = models.ForeignKey('Patient', models.DO_NOTHING, db_column='Pid')  # Field name made lowercase.
    did = models.ForeignKey('Doctor', models.DO_NOTHING, db_column='Did')  # Field name made lowercase.
    ispaid = models.IntegerField(db_column='isPaid')  # Field name made lowercase.
    price = models.FloatField(blank=True, null=True)
    date = models.DateField(db_column='DATE')  # Field name made lowercase.
    type = models.CharField(max_length=25)

    class Meta:
        managed = False
        db_table = 'counter'
```



### 2.8 RegistRelation(ç™»è®°è¡¨(æŒ‚å·)

| å±æ€§       | ä¸­æ–‡       | ç±»å‹        | å¤‡æ³¨                                   |
| ---------- | ---------- | ----------- | -------------------------------------- |
| id         | è®¢å•ç¼–å·   | VARCHAR(25) | NOT NULL, PRIMARY KEYï¼Œå¤–ç ç»§æ‰¿Counter |
| ROOMID     | è¯Šå®¤ç¼–å·   | VARCHAR(25) | NOT NULL                               |
| isFinished | æ˜¯å¦è¢«å®Œæˆ | BOOLEAN     | NOT NULL                               |

```python
class Registrelation(models.Model):
    id = models.OneToOneField(Counter, models.DO_NOTHING, db_column='id', primary_key=True)
    roomid = models.CharField(db_column='ROOMID', max_length=25)  # Field name made lowercase.
    isfinished = models.IntegerField(db_column='isFinished')  # Field name made lowercase.

    class Meta:
        managed = False
        db_table = 'registrelation'
```



### 2.10 MedicinePurchase

| å±æ€§   | ä¸­æ–‡     | ç±»å‹        | å¤‡æ³¨                   |
| ------ | -------- | ----------- | ---------------------- |
| id     | è®¢å•ç¼–å· | VARCHAR(25) | NOT NULL,ä¸»ç           |
| drugid | è¯å“ç¼–ç  | VARCHAR(25) | NOT NULLï¼Œå¤–ç ç»§æ‰¿Drug |
| amount | è´­ä¹°æ•°é‡ | FLOAT       | NOT NULL               |

```python
class Medicinepurchase(models.Model):
    id = models.OneToOneField(Counter, models.DO_NOTHING, db_column='id', primary_key=True)  # The composite primary key (id, drugId) found, that is not supported. The first column is selected.
    drugid = models.ForeignKey(Drug, models.DO_NOTHING, db_column='drugId')  # Field name made lowercase.
    amount = models.FloatField()

    class Meta:
        managed = False
        db_table = 'medicinepurchase'
        unique_together = (('id', 'drugid'),)
```



### 2.11 LaboratorySheet(åŒ–éªŒè®¢å•)

| å±æ€§       | ä¸­æ–‡         | ç±»å‹         | å¤‡æ³¨           |
| ---------- | ------------ | ------------ | -------------- |
| id         | è®¢å•ç¼–å·     | VARCHAR(25)  | NOT NULL, ä¸»ç  |
| checkName  | åŒ–éªŒåç§°     | VARCHAR(25)  | NOT NULL       |
| beginTime  | æ£€æŸ¥æ—¶é—´     | DATETIME     | NOT NULL       |
| OutputTime | ç»“æœæ—¶é—´     | DATETIME     | NOT NULL       |
| itemId     | æ£€æŸ¥é¡¹ç›®ç¼–å· | VARCHAR(25)  | NOT NULL,ä¸»ç   |
| result     | æ£€æŸ¥ç»“æœ     | VARCHAR(255) | NOT NULL       |

```python
class Laboratorysheet(models.Model):
    id = models.OneToOneField(Counter, models.DO_NOTHING, db_column='id', primary_key=True)  # The composite primary key (id, itemID) found, that is not supported. The first column is selected.
    checkname = models.CharField(db_column='checkName', max_length=255)  # Field name made lowercase.
    begintime = models.DateTimeField(db_column='beginTime')  # Field name made lowercase.
    outputtime = models.DateTimeField(db_column='OutputTime', blank=True, null=True)  # Field name made lowercase.
    itemid = models.ForeignKey(Checkitems, models.DO_NOTHING, db_column='itemID')  # Field name made lowercase.
    result = models.FloatField()

    class Meta:
        managed = False
        db_table = 'laboratorysheet'
        unique_together = (('id', 'itemid'),)
```

### 2.12 Dispatcher(åŒ»ç”Ÿæ’ç­è°ƒåº¦å™¨)

| å±æ€§       | ä¸­æ–‡                     | ç±»å‹        | å¤‡æ³¨           |
| ---------- | ------------------------ | ----------- | -------------- |
| TimePeriod | æ—¶é—´æ®µ                   | VARCHAR(25) | NOT NULLï¼Œä¸»ç  |
| ROOMID     | è¯Šå®¤ç¼–å·                 | VARCHAR(25) | NOT NULLï¼Œä¸»ç  |
| doctorId   | åŒ»ç”Ÿç¼–å·                 | VARCHAR(25) |                |
| TitleId    | è´Ÿè´£çš„ç§‘å®¤æˆ–æ´»åŠ¨åç§°ç¼–å· | VARCHAR(25) |                |
| DATE       | æ—¥æœŸï¼ˆæ˜ŸæœŸå‡ ï¼‰           | VARCHAR(15) | NOT NULL       |

```python
class Dispatcher(models.Model):
    timeperiod = models.CharField(db_column='TimePeriod', primary_key=True, max_length=25)  # Field name made lowercase. The composite primary key (TimePeriod, ROOMID, DATE) found, that is not supported. The first column is selected.
    roomid = models.ForeignKey('Room', models.DO_NOTHING, db_column='ROOMID')  # Field name made lowercase.
    doctorid = models.ForeignKey('Doctor', models.DO_NOTHING, db_column='doctorId', blank=True, null=True)  # Field name made lowercase.
    titleid = models.CharField(db_column='TitleId', max_length=25, blank=True, null=True)  # Field name made lowercase.
    date = models.CharField(db_column='DATE', max_length=15)  # Field name made lowercase.

    class Meta:
        managed = False
        db_table = 'dispatcher'
        unique_together = (('timeperiod', 'roomid', 'date'),)
```



### 2.13 diagnosis(è¯Šæ–­è®¢å•)

| å±æ€§      | ä¸­æ–‡     | ç±»å‹        | å¤‡æ³¨          |
| --------- | -------- | ----------- | ------------- |
| id        | è®¢å•ç¼–å· | VARCHAR(25) | NOT NULL,ä¸»ç  |
| patientId | ç—…äººç¼–å· | VARCHAR(25) | NOT NULL      |
| doctorId  | åŒ»ç”Ÿç¼–å· | VARCHAR(25) | NOT NULL      |
| diagnosis | è¯Šæ–­è¯´æ˜ | TEXT        | NOT NULL      |
| time      | è¯Šæ–­æ—¶é—´ | DATETIME    | NOT NULL      |

```python
class Diagnosis(models.Model):
    id = models.CharField(primary_key=True, max_length=25)
    patientid = models.ForeignKey('Patient', models.DO_NOTHING, db_column='patientId')  # Field name made lowercase.
    doctorid = models.ForeignKey('Doctor', models.DO_NOTHING, db_column='doctorId')  # Field name made lowercase.
    diagnosis = models.TextField()
    time = models.DateTimeField()

    class Meta:
        managed = False
        db_table = 'diagnosis'
```



## ç‰¹æ®Šå®ä½“è¡¨

å¯¹äºæ£€æŸ¥é¡¹ç›®ï¼Œæˆ‘ä»¬ä¸ºäº†æ–¹ä¾¿æ£€æŸ¥åˆ›å»ºäº†å¸¸ç”¨æ£€æŸ¥ç»„åˆè¡¨ï¼Œæ–¹ä¾¿åŒ»ç”Ÿç›´æ¥è¿›è¡Œæ£€æŸ¥ã€‚

### 2.14 CheckCombine(å¸¸ç”¨æ£€æŸ¥ç»„åˆ)

| å±æ€§        | ä¸­æ–‡       | å±æ€§         | å¤‡æ³¨                               |
| ----------- | ---------- | ------------ | ---------------------------------- |
| id          | ç¼–å·       | VARCHAR(25)  | NOT NULL,ä¸»ç                       |
| itemId      | æ£€æŸ¥é¡¹ç¼–å· | VARCHAR(25)  | NOT NULLï¼Œä¸»ç ï¼Œå¤–ç ç»§æ‰¿checkItems |
| description | åç§°       | VARCHAR(255) | NOT NULL                           |

```python
class Checkcombine(models.Model):
    id = models.CharField(primary_key=True, max_length=25)  # The composite primary key (id, itemId) found, that is not supported. The first column is selected.
    itemid = models.ForeignKey('Checkitems', models.DO_NOTHING, db_column='itemId')  # Field name made lowercase.
    checkname = models.CharField(db_column='checkName', max_length=255)  # Field name made lowercase.

    class Meta:
        managed = False
        db_table = 'checkcombine'
        unique_together = (('id', 'itemid'),)
```

# ä¸‰ã€ç³»ç»Ÿé‡è¦å®ç°æ–¹æ³•

## ï¼ˆtokenæœºåˆ¶ï¼‰ï¼ˆå¾…å®šï¼‰

## è§¦å‘å™¨å®ç°ä¸è®¾è®¡è¯´æ˜

æœ¬ç³»ç»Ÿä¸­çš„è§¦å‘å™¨ä¸»è¦æ¶‰åŠåœ¨åˆ é™¤è¿‡ç¨‹ä¸­ï¼Œåœ¨åˆ é™¤çš„è¿‡ç¨‹ä¸­è¿å¸¦å°†å…¶ä½œä¸ºå¤–ç çš„å…ƒç»„ä¸€å¹¶åˆ é™¤

### åˆ é™¤è¯å“

```sql
CREATE TRIGGER `DELETE_DRUG` BEFORE DELETE ON `drug` FOR EACH ROW
BEGIN
    DELETE FROM `checkcombine` WHERE `id` = OLD.id;
END

CREATE TRIGGER `DELETE_DRUG` BEFORE DELETE ON `drug` FOR EACH ROW
BEGIN
    DELETE FROM `medicinepurchase` WHERE `drugId` = OLD.id;
END
```

### åˆ é™¤ç”¨æˆ·

```sql
CREATE TRIGGER `DELETE_PATIENT` BEFORE DELETE ON `patient` FOR EACH ROW
BEGIN
    IF `patient`.`isComMem` = 1 THEN
        DELETE FROM `counter` WHERE `Pid` = OLD.id;
    END IF;
END
```

### åˆ é™¤è®¢å•

```sql
CREATE TRIGGER `DELETE_COUNTER` BEFORE DELETE ON `counter` FOR EACH ROW
BEGIN
    DELETE FROM `registrelation` WHERE `id` = OLD.id;
    DELETE FROM `laboratorysheet` WHERE `id` = OLD.id;
    DELETE FROM `medicinepurchase` WHERE `id` = OLD.id;
END
```

## å­˜å‚¨è¿‡ç¨‹è®¾è®¡ä¸è®¾è®¡è¯´æ˜

### é€šç”¨éƒ¨åˆ†

#### ç™»å½•

è¯·æ±‚è·¯å¾„ï¼š`api/login/`

æ–¹æ³•ç±»å‹ï¼š`post`

è¾“å…¥æ•°æ®ï¼š

```json
{
    username : str,
    password : str
}
```

è¾“å‡ºæ•°æ®ï¼š

```json
{
    code: number, 
    message: string, 
    type: string,
    data: 
    {
        token: string, 
        expires: float
    }
}
```

ä»£ç ï¼š

```python
def LogIn(request):
    if request.method == 'POST':
        username = request.POST.get('username',None)
        password = request.POST.get('password', None)

        db = MySQLdb.MyDatabase()
        success, code, user = db.Login(username=username, password=password)

        if user != None:
            exp = datetime.datetime.utcnow() + datetime.timedelta(days=1)
            timestamp_seconds = int(exp.timestamp())
            timestamp_milliseconds = timestamp_seconds * 1000
            payload = {
                'username': username,
                'role' : user.type,
                'exp': timestamp_milliseconds,
            }
            token = jwt.encode(payload, 'secret key', algorithm='HS256')
            request.session['username'] = username
            request.session['id'] = user.id
            request.session['type'] = user.type
            request.session.save()
            print(request.session['username'], request.session['id'], request.session['type'])
            return JsonResponse({'code': 0, 'message': 'success', 'type': user.type,
                                 'data': {'token': token, 'expires': timestamp_milliseconds}})
        else:
            return JsonResponse({
                'success': success,
                'code': code,
            })
    else:
        return HttpResponse("Not a POST request")
```

#### æ³¨å†Œ

è¯·æ±‚è·¯å¾„ï¼š`api/signUp/`

æ–¹æ³•ç±»å‹ï¼š`POST`

è¾“å…¥æ•°æ®ï¼š

```json
{
    username : string,
    password : string,
    idcard : string
}
```

è¾“å‡ºæ•°æ®ï¼š

```json
{
    code: string
}
```

ä»£ç ï¼š

```python
def SignUpByPatient(request):
    if (request.method == 'POST'):
        try:
            data = json.loads(request.body)
            username = data.get('username', '')
            password = data.get('password', '')
            print(username, password)
            idcard = data.get('idcard', '')
            db = MySQLdb.MyDatabase()
            success, status = db.SignUpByPatient(name=username, password=password, iscommem=False, idcard=idcard)
            print(success, status)
            return JsonResponse({'code': status})
        except ValueError as e:
            return JsonResponse({'success': False, 'error': 'Invalid JSON data'})
    else:
        return HttpResponse("Not a POST request")
```



#### ç™»å½•ä¿¡æ¯

ä½œç”¨è¯´æ˜ï¼šç”¨äºå‰ç«¯å®æ—¶å¾—åˆ°ç”¨æˆ·ä¿¡æ¯

è¯·æ±‚è·¯å¾„ï¼š`api/account/`

æ–¹æ³•ç±»å‹ï¼š`GET`

è¾“å…¥æ•°æ®ï¼šæ— 

è¾“å‡ºæ•°æ®ï¼š

```json
{
    account : {
        username : string,
        gender : number,
        age: number,
        avatar : string,
        jobtitle : string
    }, 
    permission : string, 
    role : string
}
```

ä»£ç 

```python
def account(request):
    # è·å– session ä¸­çš„ä¿¡æ¯

    # æ‰“å° session çš„é”®å€¼å¯¹ä¿¡æ¯
    username = request.GET.get('username', None)
    db = MySQLdb.MyDatabase()
    account = {}
    account['username'] = username
    account['gender'] = 0
    account['age'] = 18
    permissions = []
    u = db.getUserById(db.getIdByUsername(name=username))
    permissions.append(u.type)
    try:
        account['avatar'] = u.avatar
    except:
        account['avatar'] = DEFAULT_AVATAR
    if u.type == 'doctor':
        account['jobtitle'] = db.getDoctorById(id=u.id)['jobtitle']
    else:
        account['jobtitle'] = ''
    db.updateAvatar(id=u.id, avatar=account['avatar'])
    role = u.type
    j = {'account' : account, 'permission' : permissions, 'role' : role}
    return JsonResponse(j)
```

### ç—…äººéƒ¨åˆ†

#### æ™ºèƒ½å¯¼åŒ»å°

æ–¹æ³•è¯´æ˜ï¼šè°ƒç”¨åç«¯`chatgpt-api`æ¥å£å¾—åˆ°åŒ»ç–—ç®€æ˜“

è¯·æ±‚è·¯å¾„ï¼š`api/getSuggestion/`

è¾“å…¥æ•°æ®ï¼š

```json
{
    question : string
}
```

è¾“å‡ºæ•°æ®ï¼š

```json
{
    answer : string
}
```

ä»£ç ï¼š

```python
def answer(request):
    d = MySQLdb.MyDatabase()
    data = json.loads(request.body)
    content = data['question']
    departmentlist = d.GetDepartmentList()
    sendText = "ä½ å¥½ï¼Œæˆ‘æ˜¯ä¸€åç—…äººï¼Œæˆ‘çš„ç—‡çŠ¶æ˜¯" + content + "ï¼Œè¯·æˆ‘åº”è¯¥é€‰æ‹©ä»" + str(departmentlist) + "ä¸­çš„å“ªä¸ªç§‘å®¤å°±è¯Šï¼Ÿåœ¨ä¸‰ååˆ°å…«åä¸ªå­—ä»¥å†…è§£å†³ï¼Œå‡è®¾ä½ æ˜¯åŒ»é™¢çš„æ™ºèƒ½å¯¼åŒ»å°ï¼ˆä½†å›ç­”ä¸­ä¸è¦æåŠè¿™ä¸€ç‚¹ï¼‰"
    openai.api_key = GPT_API_KEY
    openai.api_base = "https://api.openai.com/v1"
    
    print(sendText)

    response = openai.ChatCompletion.create(
        model="gpt-3.5-turbo",
        messages=[
            {'role': 'user', 'content': sendText}
        ],
        temperature=0.5,
        max_tokens=300,
        stream=True
    )

    result = ""

    for chunk in response:
        if 'choices' in chunk and 'delta' in chunk['choices'][0]:
            chunk_msg = chunk['choices'][0]['delta'].get('content', '')
            result += chunk_msg  # å°†è¾“å‡ºå†…å®¹é™„åŠ åˆ°ç»“æœå­—ç¬¦ä¸²ä¸Š
            #print(chunk_msg, end='', flush=True)
            #time.sleep(0.05)

    print(result)

    return JsonResponse({"answer" : result})
```





#### è·å–ç§‘å®¤åç§°

ä½œç”¨è¯´æ˜ï¼šè·å–ç§‘å®¤åˆ—è¡¨

è¯·æ±‚è·¯å¾„ï¼š`api/departmentList/`

è¯·æ±‚ç±»å‹ï¼š`GET`

è¾“å…¥æ•°æ®ï¼šæ— 

è¾“å‡ºæ•°æ®ï¼š

```json
{
    name : [
        name : string
    ]
}
```

ä»£ç 

```python
    def GetDepartmentList(request):
    # assert request.type == 'patient'
    if (request.method == 'GET'):
        db = MySQLdb.MyDatabase()
        info = db.GetDepartmentList()
        return JsonResponse({'name' : info})
    else:
        return HttpResponse("Not a GET request")
    
    def GetDepartmentList(self):
        from .models import Titles
        result = []
        l = Titles.objects.all()
        for i in l:
            result.append(i.name)
        return result
```



#### è·å–ç§‘å®¤ä¿¡æ¯

æ–¹æ³•è¯´æ˜ï¼šè·å–ç§‘å®¤åŒ»ç”Ÿçš„å…·ä½“ä¿¡æ¯

è¯·æ±‚è·¯å¾„ï¼š`api/doctorList/`

æ–¹æ³•ç±»å‹ï¼š`POST`

è¾“å…¥æ•°æ®ï¼š

```json
{
    departmentName : string
}
```

è¾“å‡ºæ•°æ®ï¼š

```json
{
    doctorList:[
        {
            name : string,
            jobtitle : string,
            roomid : string,
            queuelen : number
        }
    ]
}
```

ä»£ç 

```python
def GetInfoListByDepartment(request):
    # assert request.type == 'patient'
    if (request.method == 'POST'):
        department = request.POST.get('departmentName',None)
        db = MySQLdb.MyDatabase()
        info = db.GetInfoListByDepartment(department)
        l = []
        for i in info:
            l.append({'name': i['doctor'], 'jobtitle' : i['jobtitle'],'room': i['room'], 'queuelen': i['queueLen']})
        L = list(l)
        print(L)
        return JsonResponse({'doctorList': L})
    else:
        return HttpResponse("Not a POST request")
```

#### ç—…äººæŒ‚å·é€‰æ‹©åŒ»ç”Ÿ

æ–¹æ³•è¯´æ˜ï¼šç—…äººé€‰æ‹©åŒ»ç”ŸæŒ‚å·

è¯·æ±‚è·¯å¾„ï¼š`api/confirmDoctor/`

æ–¹æ³•ç±»å‹ï¼š`POST`

è¾“å…¥æ•°æ®ï¼š

```json
{
    username : string,
    name : string
}
```

è¾“å‡ºæ•°æ®ï¼š

```python
{
    id : string
}
```

ä»£ç 

```python
def PatientRegistration(request):
    # assert request.type == 'patient'
    if (request.method == 'POST'):
        data = json.loads(request.body)
        print(request.body)
        name = data['userName']
        db = MySQLdb.MyDatabase()
        id = db.getIdByUsername(name=name)
        doctorId = db.getIdByUsername(data['name'])
        Payid, success, status = db.PatientRegistration(patientid=id, doctorid=doctorId)
        return JsonResponse({'id' : Payid})
    else:
        return HttpResponse("Not a POST request")

        @transaction.atomic
    def PatientRegistration(self, patientid: str, doctorid: str):
        timePeriod = self.get_time_period()
        from .models import Dispatcher, Counter, Registrelation, Patient, Room
        r0 = Dispatcher.objects.filter(doctorid=doctorid, timeperiod=timePeriod, date=self.getDate()).values_list(
            'roomid', flat=True).first()
        if r0 == None:
            print('NO DOCTOR' + doctorid + 'IN ' + timePeriod)
            return '-2', False, 404
        r = Counter.objects.filter(pid=patientid, did=doctorid, type='Registration', ispaid=False)
        if r == None:
            iscommem = Patient.objects.get(id=patientid).iscommem
            price = 1 if iscommem else 10
            id = self.createNewCounter(pid=patientid, did=doctorid, type='Registration', price=price)
            room = r0
            Registrelation.objects.create(id=Counter.objects.get(id=id), isfinished=0, roomid=room)
            print(room)
            Room.objects.filter(id=room).update(queuelen=Room.objects.get(id=room).queuelen + 1)
            return id, True, 0
        else:
            print('ALREADY REGISTERED')
            return '-2', False, 404
```



#### è·å–éœ€è¦æ”¯ä»˜çš„è®¢å•

æ–¹æ³•è¯´æ˜ï¼šå±•ç¤ºç—…äººéœ€è¦è·å–æ”¯ä»˜çš„è®¢å•

è¯·æ±‚è·¯å¾„ï¼š`api/counterToPay/`

æ–¹æ³•ç±»å‹ï¼š`GET`

è¾“å…¥æ•°æ®ï¼š

```json
{
    Pid : string
}
```

è¾“å‡ºæ•°æ®ï¼š

```json
{
    info : [
        {
            id : string,
            price : float
        }
    ]
}
```

ä»£ç 

```python
def showAllNeedtoPay(request):
    # assert request.type == 'patient'
    if (request.method == 'GET'):
        data = json.loads(request.body)
        db = MySQLdb.MyDatabase()
        Pid = data['Pid']
        # Pid = '6'
        ans = db.showAllNeedToPay(Pid=Pid)
        l = []
        for i in ans:
            jsonObj = {"id": i["id"], "price": i["price"]}
            l.append(jsonObj)
        return JsonResponse({'Info': l})
    else:
        return HttpResponse("Not a POST request")
    
    
    def showAllNeedToPay(self, Pid : str):
        from .models import Counter
        l = Counter.objects.filter(pid=Pid, ispaid=False).iterator()
        res = []
        for i in l:
            res.append({'id': i.id, 'type': i.type, 'price': i.price})
        return res

```



#### è·å–æ‰€æœ‰è®¢å•

æ–¹æ³•è¯´æ˜ï¼šç•¥

è¯·æ±‚è·¯å¾„ï¼š`api/fetchPayList/`

è¯·æ±‚ç±»å‹ï¼š`GET`

è¾“å…¥æ•°æ®ï¼š

```json
{
    username : string
}
```

è¾“å‡ºæ•°æ®ï¼š

```json
{
    Info:[
        {
            id : string,
            status : boolean,
            type : string,
            price : float
        }
    ]
}
```

ä»£ç 

```python
def showAllinCounter(request):
    # assert request.type == 'patient'
    if (request.method == 'GET'):
        db = MySQLdb.MyDatabase()
        username = request.GET.get('username', None)
        Pid = db.getIdByUsername(name=username)
        # Pid = '6'
        ans = db.showAllinCounter(Pid=Pid)
        l = []
        for i in ans:
            jsonObj = {"id": i["id"], 'status' : i['ispaid'], 'type' : i['type'], 'price' : i['price']}
            l.append(jsonObj)
        return JsonResponse({'Info': l})
        
    def showAllinCounter(self, Pid : str):
        from .models import Counter
        l = Counter.objects.filter(pid=Pid).iterator()
        res = []
        for i in l:
            res.append({'id': i.id, 'type': i.type, 'ispaid': i.ispaid, 'price': i.price})
            if i.price == None:
                print('price is None')
            else:
                print(i.price)
        return res
```

#### å¯¹æ‰€æœ‰è®¢å•ä»˜æ¬¾

æ–¹æ³•è¯´æ˜ï¼šç•¥

è¯·æ±‚è·¯å¾„ï¼š`api/payAllCounter/`

æ–¹æ³•ç±»å‹ï¼š`POST`

è¾“å…¥æ•°æ®ï¼š

```json
{
    username : string
}
```

è¾“å‡ºæ•°æ®ï¼š

```json
{
    success : string,
    code : number
}
```

ä»£ç 

```python
def PayAll(request):
    # assert request.type == 'patient'
    if request.method == 'POST':
        print("-------------------------------")
        data = json.loads(request.body)
        # Pid = '6'
        db = MySQLdb.MyDatabase()
        Pid = db.getIdByUsername(name=data['userName'])
        print(Pid)
        success, status = db.PayAll(Pid=Pid)
        return JsonResponse({'success' : success, 'code' : status})
    else:
        return HttpResponse("Not a POST request")
```



#### æ”¯ä»˜å•ä¸ªè®¢å•

æ–¹æ³•è¯´æ˜ï¼šç•¥

è¯·æ±‚è·¯å¾„ï¼š`api/finishPay/`

æ–¹æ³•ç±»å‹ï¼š`POST`

è¾“å…¥æ•°æ®ï¼š

```json
{
    id : string
}
```

è¾“å‡ºæ•°æ®ï¼š

```json
{
    message : string
}
```

ä»£ç 

```python
def finishPay(request):
    # assert request.type == 'patient'
    if request.method == 'POST':
        data = json.loads(request.body)
        Payid = data['id']
        db = MySQLdb.MyDatabase()
        if Payid != '-1':
            r = db.finishPay(id=Payid)
            if r:
                return HttpResponse('Success')
            else:
                return HttpResponse('Failed')
        else:
            print('PayAll')
            return PayAll(request=request)
```



#### è·å–è¯Šæ–­åˆ—è¡¨

æ–¹æ³•è¯´æ˜ï¼šè·å–è¯¥ç—…äººçš„è¯Šæ–­åˆ—è¡¨

è¯·æ±‚è·¯ç”±ï¼š`api/getDiagnosisByPid/`

æ–¹æ³•ç±»å‹ï¼š`GET`

è¾“å…¥æ•°æ®ï¼š

```json
{
    Pid : string
}
```

è¾“å‡ºæ•°æ®ï¼š

```json
{
    Info : [
        {
            time : string,
            statement : string
        }
    ]
}
```

ä»£ç 

```python
def getDiagnosisByPid(request):
    # assert request.type == 'patient'
    if request.method == 'GET':
        # Pid = request.session['id']
        # Pid = '6'
        data = json.loads(request.body)
        Pid = data['Pid']
        db = MySQLdb.MyDatabase()
        ans = db.getDiagnosisByPid(Pid=Pid)
        l = []
        for i in ans:
            jsonObj = {"time": i["time"], "statement": i["statement"]}
            l.append(jsonObj)
        return JsonResponse({'Info': l})
    else:
        return HttpResponse("Not a GET request")
```



#### è·å–è¯Šæ–­ç»“æœ

æ–¹æ³•è¯´æ˜ï¼šç•¥

è¯·æ±‚è·¯å¾„ï¼š`api/getDiagnosis`

æ–¹æ³•ç±»å‹ï¼š`GET`

è¾“å…¥æ•°æ®ï¼š

```json
{
    id : string
}
```

è¾“å‡ºæ•°æ®ï¼š

```json
{
    info : {
        doctor : string,
        statement : string,
        time : string
    }
}
```

ä»£ç 

```python
    def getDiagnosisById(self, id : str):
        from .models import Diagnosis
        r = Diagnosis.objects.get(id=id)
        res = {'doctor' : self.getNameById(r.doctorid.id), 'statement' : r.diagnosis, 'time' : r.time}
        return res
    
    def getDiagnosis(request):
    db = MySQLdb.MyDatabase()
    data = json.loads(request.body)
    id = data['id']
    r = db.getDiagnosisById(id=id)
    return JsonResponse({'info' : r})
```



#### è·å–åŒ–éªŒè®¢å•åˆ—è¡¨

è¯·æ±‚è·¯ç”±ï¼š`api/getLaboratorySheetids/`

è¯·æ±‚ç±»å‹ï¼š`POST`

è¾“å…¥æ•°æ®ï¼š

```json
{
    username : string
}
```

è¾“å‡ºæ•°æ®ï¼š

```json
{
    assayList : [
        id: string,
        checkName : string,
        time : string
    ]
}
```

ä»£ç 

```python
def getLaboratorySheetids(request):
    # assert request.type == 'patient'
    if request.method == 'GET':
        # Pid = request.session['id']
        # Pid = '6'
        username = request.GET.get('username', None)
        db = MySQLdb.MyDatabase()
        Pid = db.getIdByUsername(username)
        print(Pid)
        ans = db.showAllLaboratorySheetIds(Pid=Pid)
        print(ans)
        return JsonResponse({'assayList': ans})
    else:
        return HttpResponse("Not a GET request")
    
    def showAllLaboratorySheetIds(self, Pid: str):
        from .models import Laboratorysheet, Counter, Checkitems
        id = Counter.objects.filter(pid=Pid, type='Laboratory').iterator()
        res = []
        for i in id:
            print(i.id)
            if i.price == 0:
                continue
            print(i)
            l = Laboratorysheet.objects.filter(id=i)
            if len(l) != 0:
                x = l[0]
                res.append({'id': x.id.id, 'checkName' : x.checkname, 'time' : self.formatedDate(str(x.begintime))})
        return res
```



#### è·å–åŒ–éªŒç»“æœ

æ–¹æ³•è·¯å¾„ï¼š`api/getLaboratorySheet/`

æ–¹æ³•ç±»å‹ï¼š`POST`

è¾“å…¥æ•°æ®ï¼š

```json
{
    id : string
}
```

è¾“å‡ºæ•°æ®ï¼š

```json
{
    assayItemList: [
        {
            itemid : string,
            checkName : string,
            result : float,
            minresult : float,
            maxresult : float,
            outputtime : string
        }
    ]
}
```

ä»£ç 

```python
    def getLaboratorySheet(self, id: str):
        print(id)
        from .models import Laboratorysheet, Counter
        l = Laboratorysheet.objects.filter(id=Counter.objects.get(id=id)).iterator()
        print(l)
        if l == None:
            return False
        else:
            res = []
            for i in l:
                print(i)
                from .models import Checkitems
                res.append({'itemid': int(i.itemid.id), 'checkName': i.itemid.description, 'result': i.result if i.result != None else -1,
                            'minresult': i.itemid.minresult,
                            'maxresult': i.itemid.maxresult, 'outputtime': str(datetime.now()) if i.outputtime == None else self.formatedDate(str(i.outputtime))
                            })
            print(res)
            return res
    
    def getLaboratorySheetids(request):
    # assert request.type == 'patient'
    if request.method == 'GET':
        # Pid = request.session['id']
        # Pid = '6'
        username = request.GET.get('username', None)
        db = MySQLdb.MyDatabase()
        Pid = db.getIdByUsername(username)
        print(Pid)
        ans = db.showAllLaboratorySheetIds(Pid=Pid)
        print(ans)
        return JsonResponse({'assayList': ans})
    else:
        return HttpResponse("Not a GET request")
```

#### æ³¨é”€è´¦æˆ·

è¯·æ±‚è·¯å¾„ï¼š`api/deleteAccount/`

æ–¹æ³•ç±»å‹ï¼š`POST`

è¾“å…¥æ•°æ®ï¼š

```json
{
    username : string
}
```

è¾“å‡ºæ•°æ®ï¼š

```json
{
    success : boolean
}
```

ä»£ç ï¼š

```python
def deletePatient(request):
    # assert request.type == 'patient'
    if request.method == 'POST':
        # Pid = request.session['id']
        data = json.loads(request.body)
        username = data['username']
        db = MySQLdb.MyDatabase()
        Pid = db.getIdByUsername(name=username)
        db.SoftDeletePatient(id=Pid)
        return JsonResponse({"success" : True})
    else:
        return HttpResponse("Not a POST request")
```





### åŒ»ç”Ÿéƒ¨åˆ†

#### åŒ»ç”Ÿå¼€è¯

è¯·æ±‚è·¯å¾„ï¼š`api/sendMedicineList/`

è¯·æ±‚ç±»å‹ï¼š`POST`

è¾“å…¥æ•°æ®ï¼š

```json
{
    username : string,
    Pid : string,
    MedicineList : [string],
    AmountList : [number]
}
```

è¾“å‡ºæ•°æ®ï¼š

```json
{
    success : string,
    code : number
}
```

ä»£ç ï¼š

```python
def PrescribeMedication(request):
    # assert request.type == 'doctor'
    if request.method == 'POST':
        # Did = request.session['id']
        data = json.loads(request.body)
        db = MySQLdb.MyDatabase()
        username = data['username']
        print(data)
        Did = db.getIdByUsername(name=username)
        # Did = '5'
        Pid = data['Pid']
        print(Pid)
        MedcineList = data['MedicineList']
        AmountList = data['AmountList']
        if MedcineList == None or AmountList == None:
            print('NOT LIST')
            return HttpResponse("NOT LIST")
        else:
            print('LIST')
            success, status = db.PrescribeMedication(did=Did, pid=Pid, nameList=MedcineList, amount=AmountList)
            return JsonResponse({'success' : success, 'code' : status})
    else:
        return HttpResponse("Not a POST request")
    
    def PrescribeMedication(self, nameList : list, amount : list, pid: str, did: str):
        idList = []
        for i in nameList:
            from .models import Drug
            result = Drug.objects.filter(name=i)
            if len(result) == 0:
                return False, 404
            idList.append(result[0].id)

        id = self.createNewCounter(pid=pid, did=did, type='Medicine', price=0)
        if id == False:
            print(pid)
            print(did)
            return False, 404
        from .models import Medicinepurchase, Counter, Drug
        for i in range(len(idList)):
            Medicinepurchase.objects.create(id=Counter.objects.get(id=id), drugid=Drug.objects.get(id=idList[i]), amount=amount[i])
            Counter.objects.filter(id=id).update(
                price=Counter.objects.get(id=id).price + int(amount[i]) * Drug.objects.get(id=idList[i]).price)
            Drug.objects.filter(id=idList[i]).update(storage=Drug.objects.get(id=idList[i]).storage - int(amount[i]))
        return True, 0
```



#### æœç´¢è¯å“

æ”¯æŒå…³é”®è¯æœç´¢è¯å“

è¯·æ±‚è·¯å¾„ï¼š`api/getMedicineList/`

è¾“å…¥æ•°æ®

```json
{
    name : string
}
```

è¾“å‡ºæ•°æ®ï¼š

```json
{
    medicineList : [
        id : string,
        name : string,
        price : float,
        description : string
    ]
}
```

ä»£ç 

```python
    def getMedicineList(self, name : str):
        from .models import Drug
        r = Drug.objects.all().iterator()
        res = []
        for i in r:
            if i.name.find(name) != -1 or i.description.find(name) != -1:
                res.append({'id': i.id, 'name': i.name, 'price': i.price, 'amount' : i.storage, 'description' : i.description})
        return res
    
    def getMedicineList(request):
    db = MySQLdb.MyDatabase()
    name = request.GET.get('name', None)
    r = db.getMedicineList(name=name)
    print(r)
    return JsonResponse({'medicineList' : r})
```

#### è·å–åŒ–éªŒé¡¹ç›®åˆ—è¡¨

è¯·æ±‚è·¯å¾„ï¼š`api/getAnalysisName/`

è¯·æ±‚ç±»å‹ï¼š`GET`

è¾“å…¥æ•°æ®ï¼šæ— 

è¾“å‡ºæ•°æ®ï¼š

```json
{
    info : [
        checkName : string
    ]
}
```

ä»£ç ï¼š

```python
    def getAnalysisList(self):
        from .models import Checkcombine
        self.connect()
        sql = "SELECT DISTINCT checkName FROM checkCombine;"
        self.cursor.execute(sql)
        result = self.cursor.fetchall()
        return result
```

#### ç»™ç—…äººé€‰æ‹©åŒ–éªŒé¡¹ç›®

æ–¹æ³•è¯´æ˜ï¼šä¸ºç—…äººé€‰æ‹©å…·ä½“åŒ–éªŒé¡¹ç›®ï¼Œæ”¯æŒå¤šä¸ªåŒ–éªŒé¡¹ç›®åŒæ—¶è¿›è¡Œ

è¯·æ±‚è·¯å¾„ï¼š`api/sendAnalysisList/`

è¾“å…¥æ•°æ®ï¼š

```json
{
    username : string,
    Pid : string,
    AnalysisList : [
        checkName : string
    ]
}
```

è¾“å‡ºæ•°æ®ï¼š

```json
{
    success : string,
    code : number
}
```

ä»£ç ï¼š

```python
    def conductAlaboratoryAnalysis(self, Pid: str, Did: str, checkItemIds : list, checkName: str):
        from .models import Checkcombine
        m = Checkcombine.objects.filter(checkname=checkName)
        if m == None:
            assert len(checkItemIds) != 0
            from .models import Laboratorysheet, Counter
            id = str(int(Counter.objects.all().order_by('-id')[0].id) + 1)
            Counter.objects.create(id=id, pid=Pid, did=Did, price=0, ispaid=0, type='Laboratory', date=datetime.now())
            for i in checkItemIds:
                from .models import Checkitems
                Laboratorysheet.objects.create(id=id, itemid=i, time=datetime.now(), checkName=checkName)
                Counter.objects.filter(id=id).update(
                    price=Counter.objects.get(id=id).price + Checkitems.objects.get(itemid=i).price)
            return True, 0
        else:
            r = Checkcombine.objects.filter(checkname=checkName).iterator()
            l = Checkcombine.objects.filter(checkname=checkName)
            if len(l) == 0:
                return False, 404
            from .models import Laboratorysheet, Counter, Patient, Doctor, Checkitems
            id = self.genCounterId()
            Counter.objects.create(id=id, pid=Patient.objects.get(id=Pid), did=Doctor.objects.get(id=Did), price=0, ispaid=0, type='Laboratory', date=datetime.now())
            for i in r:
                from .models import Checkitems
                try:
                    Laboratorysheet.objects.create(id=Counter.objects.get(id=id), itemid=i.itemid, begintime=datetime.now(), checkname=checkName, result=-1)
                    Counter.objects.filter(id=id).update(price=Counter.objects.get(id=id).price + i.itemid.price)
                except:
                    print(i.itemid)
                    return False, 404
            return True, 0
        
  @transaction.atomic 
def conductLaboratorySheet(request):
    # assert request.type == 'doctor'
    if request.method == 'POST':
        # Did = request.session['id']
        # Did = '5'
        data = json.loads(request.body)
        username= data['username']
        db = MySQLdb.MyDatabase()
        Did = db.getIdByUsername(name=username)
        Pid = data['Pid']
        checkName = data['checkName']
        checkItemIds = data['checkItemIds'] if 'checkItemIds' in data else None
        success, status = db.conductAlaboratoryAnalysis(checkName=checkName, checkItemIds=checkItemIds, Did=Did, Pid=Pid)
        return JsonResponse({'success' : success, 'code' : status})
    else:
        return HttpResponse("Not a POST request")      

```

#### å¯¹æŒ‡å®šç—…äººä¸‹è¯Šæ–­

è¯·æ±‚è·¯ç”±ï¼š`api/sendCheckResult/`

æ–¹æ³•ç±»å‹ï¼š`POST`

æ–¹æ³•è¯´æ˜ï¼šç»™å®šç—…äººä¿¡æ¯ï¼ŒåŒ»ç”Ÿä¸ºç—…äººä¸‹è¯Šæ–­ä¹¦

è¾“å…¥æ•°æ®ï¼š

```json
{
    Pid : string,
    username : string,
    Diagnosis : string
}
```

è¾“å‡ºæ•°æ®

```json
{
    success : string,
    code : int
}
```

ä»£ç ï¼š

```python
@csrf_exempt
def MedicalDiagnosisStatement(request):
    # assert request.type == 'doctor'
    if request.method == 'POST':
        # Did = request.session['id']
        data = json.loads(request.body)
        # Did = '5'
        name = data['username']
        db = MySQLdb.MyDatabase()
        Did = db.getIdByUsername(name=name)
        Pid = data['Pid']
        Statement = data['Diagnosis']
        success, status = db.MedicalDiagnosisStatement(Did=Did, Pid=Pid, Statement=Statement)
        return JsonResponse({'success': success, 'code': status})
    else:
        return HttpResponse("Not a POST request")
    

    def MedicalDiagnosisStatement(self, Did: str, Pid: str, Statement: str):
        from .models import Diagnosis, Patient, Doctor
        if len(Diagnosis.objects.all()) == 0:
            id = '1'
        else:
            self.connect()
            sql = "SELECT MAX(CAST(id AS UNSIGNED)) AS max_id FROM DIAGNOSIS"
            self.cursor.execute(sql)
            id = self.cursor.fetchone()
            id = str(int(id['max_id']) + 1)
            self.close()
        Diagnosis.objects.create(id=id, doctorid=Doctor.objects.get(id=Did), patientid=Patient.objects.get(id=Pid), time=datetime.now(), diagnosis=Statement)
        return True, 0
```

#### æŸ¥çœ‹æ’ç­

è¯·æ±‚è·¯ç”±ï¼š`api/sendCheckResult/`

æ–¹æ³•è¯´æ˜ï¼šåŒ»ç”Ÿç•Œé¢è°ƒç”¨æ­¤æ–¹æ³•æŸ¥çœ‹åŒ»ç”Ÿçš„æ’ç­æƒ…å†µ

æ–¹æ³•ç±»å‹ï¼š`POST`

è¾“å…¥æ•°æ®ï¼š

```json
{
    username : string
}
```

è¾“å‡ºæ•°æ®ï¼š

```json
{
    info : [
        string
    ]
}
```

ä»£ç 

```python
def getDispatch(request):
    db = MySQLdb.MyDatabase()
    username = request.GET.get('username', None)
    print(username)
    id = db.getIdByUsername(name=username)
    print(id)
    r = db.getDispathcOfDoc(Did=id)
    print(r)
    return JsonResponse({'info': r})

    def getDispathcOfDoc(self, Did : str):
        from .models import Dispatcher, Doctor
        Did = Doctor.objects.get(id=Did)
        r = Dispatcher.objects.filter(doctorid=Did).iterator()
        res = []
        day = ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday']
        period = ['morning', 'afternoon']
        for i in period:
            for j in day:
                d = Dispatcher.objects.filter(doctorid=Did, date=j, timeperiod=i)
                if len(d) != 0:
                    res.append(d[0].roomid.id + 'è¯Šå®¤ğŸ˜·')
                else:
                    res.append('ä¼‘æ¯ğŸ’¤')
        print(res)
        return res
```

### ç®¡ç†å‘˜éƒ¨åˆ†

#### æ·»åŠ åŒ»ç”Ÿ

æ–¹æ³•è¯´æ˜ï¼šç•¥

è¯·æ±‚è·¯ç”±ï¼š`api/sendDoctorList/`

è¾“å…¥æ•°æ®ï¼š

```json
{
    username : string
    tittle : string
    password : string
}
```

è¾“å‡ºæ•°æ®ï¼š

```json
{
    success : boolean
}
```

ä»£ç ï¼š

```python
def addDoctor(request):
    db = MySQLdb.MyDatabase()
    data = json.loads(request.body)
    name = data['username']
    tittle = data['tittle']
    password = data['password']
    l, _ = db.addDoctor(name=name, tittle=tittle, password=password)
    return JsonResponse({'success': l})

    def addDoctor(self, name: str, tittle: str, password: str):
        from .models import Doctor, User
        id = self.genUserId()
        User.objects.create(id=id, username=name, password=password, type='Doctor', avatar=DEFAULT_AVATAR)
        Doctor.objects.create(id=id, tid=self.getTidByName(name=tittle), active=1, jobtitle='ä¸»æ²»åŒ»å¸ˆ')
        return True, 0
```

#### æ·»åŠ ç¤¾åŒºç—…äºº

æ–¹æ³•è¯´æ˜ï¼šç•¥

è¯·æ±‚è·¯ç”±ï¼š`api/addPatient/`

è¾“å…¥æ•°æ®ï¼š

```json
{
    username : string,
    password : string
}
```

è¾“å‡ºæ•°æ®ï¼š

```json
{
    success : boolean
}
```

ä»£ç ï¼š

```python
    def addCommemPatient(self, username : str, password : str):
        from .models import User, Patient
        id = self.genUserId()
        User.objects.create(id=id, username=username, password=password, type='patient', avatar=DEFAULT_AVATAR)
        Patient.objects.create(id=id, iscommem=True, active=True)
        return True, 0
```

#### ç®¡ç†è¯å“

ç®¡ç†è¯å“åŒ…æ‹¬äº†æŸ¥è¯¢è¯å“ï¼Œæ–°å¢è¯å“ï¼Œåˆ é™¤è¯å“

##### æŸ¥è¯¢è¯å“

åŒåŒ»ç”Ÿéƒ¨åˆ†

##### æ–°å¢è¯å“

è¯·æ±‚è·¯ç”±ï¼š`api/addMedicine/`

è¾“å…¥æ•°æ®ï¼š

```json
{
    Medicine : string,
    Amount : FLOAT,
    Price : FLOAT,
    Description : string
}
```

è¾“å‡ºæ•°æ®ï¼š

```json
{
    success : boolean
}
```

ä»£ç ï¼š

```python
def addMedicine(request):
    data = json.loads(request.body)
    Medicine = data['Medicine']
    Amount = data['Amount']
    Price = data['Price']
    Description = data['Description']
    db = MySQLdb.MyDatabase()
    db.addMedicine(name=Medicine, amount=Amount, price=Price, description=Description)
    return JsonResponse({'success': True})

    def addMedicine(self, name : str, price : float, amount : int, description : str):
        from .models import Drug
        d = Drug.objects.get(name=name)
        if d is None:
            self.connect()
            sql = "SELECT MAX(CAST(id AS UNSIGNED)) AS max_id FROM DRUG"
            self.cursor.execute(sql)
            result = self.cursor.fetchone()
            max_id = result['max_id']
            id = str(int(max_id) + 1)
            Drug.objects.create(id=id, name=name, price=price, storage=amount, description=description, isbanned=False)
            return True, 0
        else:
            Drug.objects.filter(name=name).update(storage=Drug.objects.get(name=name).storage+float(amount))
            return True, 0
```

##### åˆ é™¤è¯å“

è¯·æ±‚è·¯ç”±ï¼š`api/hardDeleteDrug/`

è¾“å…¥æ•°æ®ï¼š

```json
{
    name : string
}
```

è¾“å‡ºæ•°æ®ï¼š

```json
{
    success : boolean
}
```

ä»£ç ï¼š

```python
def hardDeleteDrug(request):
    assert request.type == 'admin'
    if request.method == 'POST':
        name = request.get('name')
        db = MySQLdb.MyDatabase()
        db.HardDeleteDrug(name=name)
        return JsonResponse({'success': True, 'code': 0})
    else:
        return HttpResponse("Not a POST request")

    def HardDeleteDrug(self, id: str):
        from .models import Drug
        self.connect()
        sql = "DELETE FROM DRUG WHERE id = %s"
        self.cursor.execute(sql, id)
        self.connection.commit()
        return True
```



#### æŸ¥çœ‹åŒ»ç”Ÿ

è¯·æ±‚è·¯ç”±ï¼š`api/getAllDoctors/`

æ–¹æ³•ç±»å‹ï¼š`GET`

è¾“å…¥æ•°æ®ï¼šæ— 

è¾“å‡ºæ•°æ®ï¼š

```json
{
    doctorList : [
        {
            id : string,
            name : string,
            jobtitle : string,
            department : string
        }
    ]
}
```

ä»£ç ï¼š

```python
    def getAllDoctors(self):
        from .models import Doctor, User
        r = Doctor.objects.all().iterator()
        res = []
        for i in r:
            res.append({'id': i.id, 'name': User.objects.get(id=i.id).username, 'department': i.tid.name, 'jobtitle' : i.jobtitle})
        return res
```



#### æŸ¥çœ‹æ‚£è€…

è¯·æ±‚è·¯ç”±ï¼š`api/getAllPatients/`

æ–¹æ³•ç±»å‹ï¼š`GET`

è¾“å…¥æ•°æ®ï¼šæ— 

è¾“å‡ºæ•°æ®ï¼š

```json
{
    patientList : [
        
        {
            id : string,
            name : string,
            iscommem : string,
            sum : number,
        }
    ]
}
```

ä»£ç ï¼š

```python
    def getAllPatients(self):
        from .models import Patient, User
        r = Patient.objects.filter(active=True).iterator()
        res = []
        for i in r:
            res.append({'id': i.id, 'name': User.objects.get(id=i.id).username, 'iscommem': 'ç¤¾åŒºç”¨æˆ·' if i.iscommem else 'éç¤¾åŒºç”¨æˆ·', 'sum' : self.getCounterSumOfPatient(i.id)})
        res.sort(key=lambda x: x['sum'], reverse=True)
        return res
```



# å››ã€ç³»ç»Ÿå®ç°æ•ˆæœ

## 4.1å…¬æœ‰ç•Œé¢

### 4.1.1ç³»ç»Ÿé¦–é¡µ

ç”¨æˆ·è¿›å…¥ç½‘ç«™åä¼šé¦–å…ˆè¿›å…¥ç³»ç»Ÿçš„é¦–é¡µï¼Œé¦–é¡µç®€å•ä»‹ç»äº†ç³»ç»Ÿçš„åŠŸèƒ½ï¼Œä¹‹åç”¨æˆ·å¯ä»¥ç‚¹å‡»ç™»å½•æŒ‰é’®è¿›å…¥ç³»ç»Ÿç™»å½•ç•Œé¢ã€‚

![image-20231211191940784](https://alist.sanyue.site/d/imgbed/202312111922599.png)

### 4.1.2ç™»å½•ç•Œé¢

ç”¨æˆ·ç™»å…¥ç³»ç»Ÿçš„ç•Œé¢ï¼ŒåŒ»ç”Ÿã€ç—…äººã€ç®¡ç†å‘˜ä¸‰æ–¹ä½¿ç”¨ç»Ÿä¸€ç™»å½•ç•Œé¢ï¼Œå¯ä»¥ä½¿ç”¨ç”¨æˆ·å/ç”¨æˆ·ç¼–å·å’Œå¯†ç è¿›è¡Œç™»å½•ï¼Œå¦‚æœæ²¡æœ‰è¾“å…¥æŸä¸€é¡¹æˆ–è€…ç”¨æˆ·åå¯†ç é”™è¯¯ï¼Œè¯¥ç•Œé¢ä¼šç»™å‡ºç›¸åº”æç¤ºã€‚

![image-20231211193800701](https://alist.sanyue.site/d/imgbed/202312111938645.png)

### 4.1.3æ³¨å†Œç•Œé¢

æ ¹æ®è®¾è®¡ï¼Œæ³¨å†Œç•Œé¢ç›®å‰ä»…æ”¯æŒ**éç¤¾åŒºç”¨æˆ·æ³¨å†Œ**ï¼Œç”±äºç³»ç»Ÿä¸­ä¹‹å‰æ²¡æœ‰è¿‡è¿™äº›ç”¨æˆ·çš„ä¿¡æ¯ï¼Œå› æ­¤éœ€è¦ä»–ä»¬åœ¨è®¾ç½®è‡ªå·±çš„ç”¨æˆ·åå’Œå¯†ç çš„åŒæ—¶è¾“å…¥è‡ªå·±çš„èº«ä»½è¯å·è¿›è¡Œèº«ä»½çš„è®¤è¯ã€‚

![image-20231211194257039](https://alist.sanyue.site/d/imgbed/202312111942939.png)

### 4.1.4ä¸»é¡µ

æ‰€æœ‰ç”¨æˆ·ï¼ˆåŒ»ç”Ÿã€ç—…äººã€ç®¡ç†å‘˜ï¼‰è¿›å…¥ç³»ç»Ÿåéƒ½ä¼šè¢«è·¯ç”±åˆ°ä¸»é¡µï¼Œè¿™é‡Œä¼šæœ‰è¿›å…¥ç³»ç»Ÿçš„æ¬¢è¿è¾ï¼ŒåŒæ—¶è¿˜è®¾ç½®äº†**æ™ºèƒ½å¯¼åŒ»å°åŠŸèƒ½**ï¼Œé€šè¿‡è°ƒç”¨ChatGptæ¥å£ï¼Œæ ¹æ®ç”¨æˆ·è¾“å…¥çš„è‡ªå·±çš„ç—…æƒ…ç»™ç”¨æˆ·æä¾›ä¸€äº›å»ºè®®ï¼ŒåŒ…æ‹¬å°±è¯Šç§‘å®¤ç­‰å†…å®¹ã€‚

![image-20231211200950318](https://alist.sanyue.site/d/imgbed/202312112010295.png)

### 4.1.5ä¸ªäººä¸­å¿ƒ

ä¸ªäººä¸­å¿ƒå±•ç¤ºäº†ç”¨æˆ·çš„ç”¨æˆ·åã€è§’è‰²ï¼ˆåŒ»ç”Ÿã€ç—…äººã€ç®¡ç†å‘˜ï¼‰ç­‰ä¿¡æ¯ï¼ŒåŒæ—¶æä¾›äº†**é€€å‡ºç™»å½•**å’Œ**æ³¨é”€è´¦å·**æ“ä½œã€‚ç‚¹å‡»é€€å‡ºç™»å½•åä¼šè¿”å›åˆ°ç³»ç»Ÿç™»å½•é¡µé¢ï¼Œç‚¹å‡»æ³¨é”€è´¦å·ä¼šå‡ºç°è­¦ç¤ºå¼¹çª—ï¼Œå¦‚æœç”¨æˆ·ç¡®è®¤è¦æ³¨é”€è´¦å·ï¼Œåˆ™æˆåŠŸæ³¨é”€åè¿”å›åˆ°ç³»ç»Ÿçš„ç™»å½•é¡µé¢ã€‚

![image-20231211205759734](https://alist.sanyue.site/d/imgbed/202312112057918.png)

ï¼ˆç¡®è®¤æ³¨é”€è´¦å·å¼¹çª—ï¼‰

![image-20231211211120985](https://alist.sanyue.site/d/imgbed/202312112111799.png)

 ## 4.2ç—…äººç•Œé¢

### 4.2.1æŒ‚å·é¢„çº¦ç•Œé¢

ç½—åˆ—äº†åŒ»é™¢æ‰€æœ‰å¯ä»¥æŒ‚å·åœ°ç§‘å®¤ï¼Œç—…äººå¯ä»¥ç»“åˆæ™ºèƒ½å¯¼åŒ»å°çš„å»ºè®®å’Œè‡ªå·±çš„å®é™…æƒ…å†µé€‰æ‹©éœ€è¦å°±è¯Šçš„ç§‘å®¤ï¼Œè¿›å…¥åŒ»ç”Ÿé€‰æ‹©ç•Œé¢ã€‚

![image-20231211201201479](https://alist.sanyue.site/d/imgbed/202312112012774.png)

### 4.2.2åŒ»ç”Ÿé€‰æ‹©ç•Œé¢

è¿›å…¥åŒ»ç”Ÿé€‰æ‹©ç•Œé¢åï¼Œç—…äººèƒ½å¤Ÿçœ‹åˆ°å½“å‰è¯¥ç§‘å®¤æ‰€æœ‰å¯æ¥è¯Šçš„åŒ»ç”Ÿçš„æœ‰å…³ä¿¡æ¯ï¼ˆä¼‘æ¯çš„åŒ»ç”Ÿä¸ä¼šæ˜¾ç¤ºï¼‰ï¼ŒåŒ…å«è¯Šå®¤ç¼–å·ã€æ’é˜Ÿäººæ•°ï¼ˆå«è¯Šå®¤é˜Ÿä¼æ‹¥æŒ¤æƒ…å†µï¼‰ç­‰ï¼Œç—…äººå¯ä»¥æ ¹æ®æœ‰å…³ä¿¡æ¯é¢„çº¦å¯¹åº”çš„åŒ»ç”Ÿã€‚

![image-20231211201436751](https://alist.sanyue.site/d/imgbed/202312112014946.png)

### 4.2.3æŒ‚å·ç¼´è´¹ç•Œé¢

é€‰æ‹©å¥½åŒ»ç”Ÿåï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨è·³è½¬åˆ°ç¼´è´¹ç•Œé¢ï¼Œéç¤¾åŒºç—…äººæŒ‚å·è´¹ä¸º10å…ƒï¼Œç¤¾åŒºç—…äººæŒ‚å·è´¹ä¸º1å…ƒï¼Œç”¨æˆ·å¯ä»¥é€‰æ‹©ç«‹å³ç¼´è´¹æˆ–ç¨åç¼´è´¹ï¼Œé€‰æ‹©åè·³è½¬å›åˆ°åŒ»ç”Ÿé€‰æ‹©ç•Œé¢ã€‚

![image-20231211201759551](https://alist.sanyue.site/d/imgbed/202312112017732.png)

### 4.2.4è´¹ç”¨æ¸…å•

å±•ç¤ºç—…äººå½“å‰æ‰€æœ‰çš„è´¹ç”¨æ¸…å•ï¼ŒåŒ…å«å·²ç¼´è´¹å’Œæœªç¼´è´¹çš„è´¦å•ï¼Œç«‹å³ç¼´è´¹åŠŸèƒ½ä¼š**è®¡ç®—æ‰€æœ‰æœªç¼´è´¹è´¦å•çš„æ€»é¢**ï¼Œç„¶åè·³è½¬åˆ°ç¼´è´¹ç•Œé¢ï¼ˆä¸æŒ‚å·ç¼´è´¹ç•Œé¢ç±»ä¼¼ï¼‰ã€‚

![image-20231211202356072](https://alist.sanyue.site/d/imgbed/202312112023201.png)

### 4.2.5åŒ–éªŒç»“æœæŸ¥è¯¢

å±•ç¤ºç—…äººå½“å‰æ‰€æœ‰çš„åŒ–éªŒç»“æœï¼Œå±•ç¤ºåŒ–éªŒ**ç»“æœç¼–å·ã€åŒ–éªŒåç§°ã€åŒ–éªŒæ—¶é—´**ç­‰ä¿¡æ¯ï¼Œç”¨æˆ·å¯ä»¥é€‰æ‹©æƒ³è¦æŸ¥è¯¢çš„å…·ä½“åŒ–éªŒç»“æœï¼Œç‚¹å‡»`æŸ¥çœ‹è¯¦æƒ…`è¿›å…¥è¯¥é¡¹åŒ–éªŒç»“æœçš„è¯¦æƒ…é¡µã€‚

![image-20231211202803468](https://alist.sanyue.site/d/imgbed/202312112028672.png)

### 4.2.6åŒ–éªŒè¯¦æƒ…æŸ¥çœ‹

å±•ç¤ºæŸä¸€ä¸ªåŒ–éªŒå†…å®¹çš„å…·ä½“ç»“æœï¼ŒåŒ…å«**é¡¹ç›®ç¼–å·ï¼ŒåŒ–éªŒé¡¹ç›®ï¼ŒåŒ–éªŒç»“æœï¼Œæœ€å°å‚è€ƒå€¼ï¼Œæœ€å¤§å‚è€ƒå€¼ï¼ŒåŒ–éªŒæ—¶é—´**ç­‰å†…å®¹ã€‚å…¶ä¸­ï¼Œæ¯ä¸€é¡¹çš„åŒ–éªŒç»“æœä¼šæ ¹æ®æœ€å°å‚è€ƒå€¼å’Œæœ€å¤§å‚è€ƒå€¼ä»¥åŠå®é™…ç»“æœåˆ¤æ–­ç»“æœæ˜¯å¦åœ¨æ­£å¸¸èŒƒå›´å†…ï¼Œå¹¶ä¸”ç›´è§‚åœ°ç»™å‡º`æ­£å¸¸`æˆ–`å¼‚å¸¸`çš„è¯„ä¼°ã€‚

![image-20231211203034553](https://alist.sanyue.site/d/imgbed/202312112030674.png)

### 4.2.7è¯Šæ–­ç»“æœæ¸…å•

å±•ç¤ºç—…äººæ‰€æœ‰çš„è¯Šæ–­ç»“æœï¼ŒåŒ…å«å¼€å…·è¯¥è¯Šæ–­ç»“æœçš„**åŒ»ç”Ÿå§“åï¼Œè¯Šæ–­æ—¶é—´**ï¼Œç‚¹å‡»`æŸ¥çœ‹è¯¦æƒ…`åå¯ä»¥è·³è½¬åˆ°å…·ä½“çš„è¯Šæ–­ç»“æœé¡µé¢ã€‚

![image-20231211204302419](https://alist.sanyue.site/d/imgbed/202312112043543.png)

### 4.2.8è¯Šæ–­è¯¦æƒ…

å±•ç¤ºå…·ä½“çš„è¯Šæ–­è¯¦æƒ…ï¼ŒåŒ…æ‹¬**è¯Šæ–­ç»“æœã€ç¼–å·ã€åŒ»ç”Ÿå§“åã€è¯Šæ–­æ—¶é—´**ç­‰å†…å®¹ã€‚

![image-20231211205457002](https://alist.sanyue.site/d/imgbed/202312112054208.png)

# äº”ã€æ„Ÿæƒ³

